(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-596e36cf"],{"338a":function(e,t,a){"use strict";a("99af"),a("4160"),a("a15b"),a("d81d"),a("b0c0"),a("b64b"),a("d3b7"),a("159b");var n=a("5530"),i=a("365c"),o=[{name:"IP",componentName:"ipComponent",columns:[{width:100,title:"序号",dataIndex:"index"},{width:200,title:"IP",dataIndex:"ip"},{width:250,title:"操作系统",dataIndex:"os_name"},{width:320,title:"开放端口",dataIndex:"port"},{width:300,title:"关联域名",dataIndex:"domain",scopedSlots:{customRender:"arrTip"}},{width:200,title:"Geo",dataIndex:"geo_city"},{width:300,title:"AS",dataIndex:"geo_asn"}],api:i.g,dataList:[],total:0,params:{page:1,size:10},searchGroup:[{type:"number",label:"IP",value:"ip"},{type:"number",label:"端口",value:"port_info.port_id"},{label:"操作系统",value:"os_info.name"},{label:"域名",value:"domain"}]},{name:"SSL证书",componentName:"sslComponent",columns:[{width:100,title:"序号",dataIndex:"index"},{width:280,title:"HOST",dataIndex:"ipInfo"},{title:"CERT",dataIndex:"detailInfo",scopedSlots:{customRender:"sslDetailInfo"}}],api:i.b,total:0,params:{page:1,size:10},searchGroup:[{label:"签发者名称",value:"cert.issuer.common_name"},{label:"主题名称",value:"cert.subject_dn"},{label:"SHA-1",value:"cert.fingerprint.sha256"},{label:"使用者备用名称",value:"cert.extensions.subjectAltName"}]},{name:"子域名",componentName:"subdomainComponent",columns:[{width:100,title:"序号",dataIndex:"index"},{width:300,title:"域名",dataIndex:"domain",scopedSlots:{customRender:"tooltip"}},{width:220,title:"解析类型",dataIndex:"type"},{width:350,title:"记录值",dataIndex:"record",scopedSlots:{customRender:"arrTip"}},{width:350,title:"关联IP",dataIndex:"ips",scopedSlots:{customRender:"arrTip"}},{width:100,title:"来源",dataIndex:"source"}],dataList:[],api:i.f,total:0,params:{page:1,size:10},searchGroup:[{label:"域名",value:"domain"},{label:"记录值",value:"record"},{label:"类型",value:"type"},{type:"number",label:"IP",value:"ips"},{label:"来源",value:"source"}]},{name:"站点",componentName:"siteComponent",columns:[{width:100,title:"序号",dataIndex:"index"},{width:300,title:"站点",dataIndex:"site",scopedSlots:{customRender:"site"}},{width:300,title:"标题",dataIndex:"title"},{width:400,title:"headers",dataIndex:"headers",scopedSlots:{customRender:"headers"}},{width:200,title:"finger",dataIndex:"finger",scopedSlots:{customRender:"finger"}},{width:300,title:"截图",dataIndex:"screenshot",scopedSlots:{customRender:"screenshot"}}],api:i.j,total:0,params:{page:1,size:10},searchGroup:[{label:"站点",value:"site"},{label:"主机名",value:"hostname"},{label:"标题",value:"title"},{label:"Web Server",value:"http_server"},{label:"状态码",value:"status"},{label:"标头",value:"headers"},{label:"指 纹",value:"finger.name"},{label:"favicon hash",value:"favicon.hash"}]},{name:"服务",componentName:"serveComponent",columns:[{title:"序号",dataIndex:"index"},{title:"服务",dataIndex:"service_name"},{title:"IP端口",dataIndex:"protsArr",scopedSlots:{customRender:"showAll"}},{title:"Product",dataIndex:"productArr",scopedSlots:{customRender:"productAll"}}],api:i.i,total:0,searchGroup:[{label:"服务",value:"service_name"},{label:"IP",value:"service_info.ip"},{label:"端口",value:"service_info.port_id"},{label:"产品",value:"service_info.product"}],params:{page:1,size:10}},{name:"文件泄露",componentName:"fileComponent",columns:[{width:88,title:"序号",dataIndex:"index"},{title:"URL",dataIndex:"url",scopedSlots:{customRender:"urlItem"}},{width:400,title:"标题",dataIndex:"title"},{width:200,title:"状态码",dataIndex:"status_code"},{width:300,title:"body 长度",dataIndex:"content_length"}],api:i.d,total:0,searchGroup:[{label:"URL",value:"url"},{label:"标题",value:"title"},{label:"状态码",value:"status_code"},{label:"body 长度",value:"content_length"}],params:{page:1,size:10}},{name:"URL信息",componentName:"fileComponent",columns:[{width:88,title:"序号",dataIndex:"index"},{title:"URL",dataIndex:"url",scopedSlots:{customRender:"urlItem"}},{width:400,title:"标题",dataIndex:"title"},{width:200,title:"状态码",dataIndex:"status_code"},{width:300,title:"body 长度",dataIndex:"content_length"},{width:200,title:"来源",dataIndex:"source"}],api:i.k,total:0,searchGroup:[{label:"URL",value:"url"},{label:"标题",value:"title"},{label:"状态码",value:"status_code"},{label:"body 长度",value:"content_length"},{label:"来源",value:"source"}],params:{page:1,size:10}}],s=[{name:"IP",componentName:"ipComponent",columns:[{width:100,title:"序号",dataIndex:"index",scopedSlots:{customRender:"dataIndex"}},{width:200,title:"IP",dataIndex:"ip"},{width:250,title:"操作系统",dataIndex:"os_name"},{width:320,title:"开放端口",dataIndex:"port"},{width:300,title:"关联域名",dataIndex:"domain",scopedSlots:{customRender:"arrTip"}},{width:200,title:"Geo",dataIndex:"geo_city"},{width:300,title:"AS",dataIndex:"geo_asn"}],api:i.g,dataList:[],total:0,params:{page:1,size:10},searchGroup:[{type:"number",label:"IP",value:"ip"},{type:"number",label:"端口",value:"port_info.port_id"},{label:"操作系统",value:"os_info.name"},{label:"域名",value:"domain"}]},{name:"子域名",componentName:"subdomainComponent",columns:[{width:100,title:"序号",dataIndex:"index",scopedSlots:{customRender:"dataIndex"}},{width:300,title:"域名",dataIndex:"domain",scopedSlots:{customRender:"tooltip"}},{width:220,title:"解析类型",dataIndex:"type"},{width:350,title:"记录值",dataIndex:"record",scopedSlots:{customRender:"arrTip"}},{width:350,title:"关联IP",dataIndex:"ips",scopedSlots:{customRender:"arrTip"}},{width:100,title:"来源",dataIndex:"source"}],dataList:[],api:i.f,total:0,params:{page:1,size:10},searchGroup:[{label:"域名",value:"domain"},{label:"记录值",value:"record"},{label:"类型",value:"type"},{type:"number",label:"IP",value:"ips"},{label:"来源",value:"source"}]},{name:"站点",componentName:"siteComponent",columns:[{width:100,title:"序号",dataIndex:"index",scopedSlots:{customRender:"dataIndex"}},{width:300,title:"站点",dataIndex:"site",scopedSlots:{customRender:"site"}},{width:300,title:"标题",dataIndex:"title"},{width:400,title:"headers",dataIndex:"headers",scopedSlots:{customRender:"headers"}},{width:200,title:"finger",dataIndex:"finger",scopedSlots:{customRender:"finger"}},{width:300,title:"截图",dataIndex:"screenshot",scopedSlots:{customRender:"screenshot"}}],api:i.j,total:0,params:{page:1,size:10},searchGroup:[{label:"站点",value:"site"},{label:"主机名",value:"hostname"},{label:"标题",value:"title"},{label:"Web Server",value:"http_server"},{label:"状态码",value:"status"},{label:"标头",value:"headers"},{label:"指 纹",value:"finger.name"},{label:"favicon hash",value:"favicon.hash"}]}];t.a={mounted:function(){this.tableConfig=this.$route.query.task_id?o:s,this.changeTabs(0)},data:function(){return{tableConfig:[],currentIndex:0,currentKey:(new Date).getTime(),targetName:this.$route.query.target+"相关资产",currentComponent:{columns:[],total:0,dataList:[],searchGroup:[],params:{page:1,size:10}},isLoading:!1,tabList:["IP","SSL证书","子域名","站点","服务","文件泄露","URL信息"],imgVisible:!1,imgSrc:""}},watch:{$route:function(e,t){this.targetName=this.$route.query.target+"相关资产",this.currentComponent.tableList=[],this.currentComponent.total=0,this.currentIndex=0,this.changeTabs(0)}},computed:{page_num:function(){return this.currentComponent.total%this.currentComponent.params.size>0?parseInt(this.currentComponent.total/this.currentComponent.params.size)+1:this.currentComponent.total/this.currentComponent.params.size}},methods:{changeTabs:function(e){this.currentKey=(new Date).getTime(),this.currentIndex=e,this.currentComponent.columns=this.tableConfig[e].columns,this.currentComponent.params={},this.currentComponent.params.page=this.tableConfig[this.currentIndex].params.page,this.currentComponent.params.size=this.tableConfig[this.currentIndex].params.size,this.initParams(e),this.tableConfig[this.currentIndex].params={page:1,size:10},this.initData(e)},searchContent:function(e,t){this.tableConfig[this.currentIndex].params.page=1,this.currentComponent.params.page=1,this.tableConfig[this.currentIndex].params.size=10,this.currentComponent.params.size=10,this.tableConfig[this.currentIndex].params[e]=t+"",this.initData(this.currentIndex)},changeSearchContent:function(e,t){this.tableConfig[this.currentIndex].params[e]=t.target.value+""},initData:function(e){var t=this;this.isLoading=!0;var a={};Object.keys(this.tableConfig[e].params).forEach((function(n){void 0!==t.tableConfig[e].params[n]&&t.tableConfig[e].params[n]&&(a[n]=t.tableConfig[e].params[n])})),this.$route.query.task_id&&(a.task_id=this.$route.query.task_id),this.tableConfig[e].api(Object(n.a)({},a)).then((function(e){e.items.forEach((function(e,a){e.key=e._id,e.index=(t.currentComponent.params.page-1)*t.currentComponent.params.size+a+1,t.transformItem(e),Object.keys(e).forEach((function(t){e[t]||(e[t]="-")}))})),t.currentComponent.tableList=e.items,t.currentComponent.total=e.total,document.querySelector("#contentWrap").scrollTop=0})).finally((function(){t.isLoading=!1}))},transformItem:function(e){switch(this.currentIndex){case 0:this.transformIp(e);break;case 1:this.transformSSL(e);break;case 3:this.transformSite(e);break;case 4:this.transformServe(e);break;case 5:this.transformFile(e)}},transformIp:function(e){e.os_name="{}"===(void 0===e.geo_city&&JSON.stringify(e.os_info))?"-":e.os_info.name,e.port=e.port_info.length?e.port_info.map((function(e){return e.port_id})).join(", "):"-",e.geo_asn=void 0===e.geo_asn||"{}"===JSON.stringify(e.geo_asn)?"-":e.geo_asn.organization,e.geo_city="{}"===(void 0===e.geo_city&&JSON.stringify(e.geo_city))?"-":!(void 0===e.geo_city||void 0===e.geo_city.city)&&e.geo_city.country_name+" / "+e.geo_city.region_name},transformSSL:function(e){e.ipInfo="".concat(e.ip,":").concat(e.port),e.detailInfo={subjectName:void 0===e.cert.subject_dn?"":e.cert.subject_dn,issuerName:e.cert.issuer.common_name,useName:e.cert.extensions.subjectAltName,serialName:e.cert.serial_number,rangeTime:"".concat(e.cert.validity.start," 至 ").concat(e.cert.validity.end),endTime:e.cert.validity.end,sha256:e.cert.fingerprint.sha256,sha1:e.cert.fingerprint.sha1,md5:e.cert.fingerprint.md5}},transformSite:function(e){e.hash=e.favicon&&e.favicon.hash},transformServe:function(e){e.protsArr=[],e.productArr=[],e.service_info.forEach((function(t){e.protsArr.push(t.ip+":"+t.port_id),e.productArr.push({name:t.product?t.product:"-",version:t.version})}))},transformFile:function(e){e.content_length=e.content_length?e.content_length:"0"},checkProductRepeat:function(e,t,a){if(!e)return!0;var n=!1;return a.forEach((function(t){t.name===e&&(n=!0)})),n},initParams:function(e){this.currentComponent={columns:this.tableConfig[e].columns,total:this.tableConfig[e].total,tableList:this.tableConfig[e].tableList,searchGroup:this.tableConfig[e].searchGroup,params:{page:this.tableConfig[e].params.page,size:this.tableConfig[e].params.size}}},changeFunction:function(e,t){this.tableConfig[this.currentIndex].params.page=e,this.tableConfig[this.currentIndex].params.size=t,this.currentComponent.params.page=e,this.currentComponent.params.size=t,this.initData(this.currentIndex)}}}},"57ab":function(e,t,a){"use strict";a.r(t);var n={mixins:[a("338a").a],data:function(){return{tabList:["IP","子域名","站点"]}},methods:{transformItem:function(e){switch(this.currentIndex){case 0:this.transformIp(e);break;case 2:this.transformSite(e)}}}},i=a("2877"),o=Object(i.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-wrap"},[a("a-tabs",{attrs:{type:"card",tabBarGutter:8},on:{change:e.changeTabs},model:{value:e.currentIndex,callback:function(t){e.currentIndex=t},expression:"currentIndex"}},e._l(e.tabList,(function(e,t){return a("a-tab-pane",{key:t,attrs:{tab:e}})})),1),a("div",{staticClass:"search-wrap"},e._l(e.currentComponent.searchGroup,(function(t,n){return a("span",{key:n,staticClass:"item"},[a("span",{staticClass:"label"},[e._v(e._s(t.label+"："))]),a("a-input-search",{key:e.currentKey+n,staticStyle:{width:"250px"},attrs:{allowClear:"",placeholder:"请输入"+t.label+"进行搜索"},on:{change:function(a){return e.changeSearchContent(t.value,a)},search:function(a){return e.searchContent(t.value,a)}}})],1)})),0),a("table-component",{attrs:{columns:e.currentComponent.columns,loading:e.isLoading,tableList:e.currentComponent.tableList,pagination:!1,total:e.currentComponent.total,params:e.currentComponent.params},on:{changeFunction:e.changeFunction}})],1)}),[],!1,null,null,null);t.default=o.exports}}]);